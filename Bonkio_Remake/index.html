<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Bonk.io AI Trainer</title>
	<!--
	these imports had been taken from generated ../javascript/Box2D/load.html
	uncomment these and comment out box2d.min.js to debug box2d itself.
	
	<script src="../javascript/misc/extend.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2BoundValues.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2PairManager.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2TimeStep.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Controllers/b2Controller.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Controllers/b2GravityController.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2DestructionListener.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2ContactEdge.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/Shapes/b2EdgeChainDef.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Common/Math/b2Vec2.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Common/Math/b2Vec3.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2DistanceProxy.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2ContactFactory.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Controllers/b2ConstantAccelController.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2SeparationFunction.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2DynamicTreePair.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2ContactConstraintPoint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Controllers/b2ControllerEdge.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2DistanceInput.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Common/b2Settings.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2Proxy.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2Point.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2WorldManifold.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2RayCastOutput.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Controllers/b2ConstantForceController.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/Shapes/b2MassData.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2DynamicTree.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2JointEdge.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2RayCastInput.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/Features.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2FilterData.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2AABB.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2Jacobian.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2Bound.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2SimplexVertex.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Common/Math/b2Mat22.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2SimplexCache.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/Shapes/b2Shape.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2Segment.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2ContactRegister.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2DebugDraw.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Common/Math/b2Sweep.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2DistanceOutput.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Common/Math/b2Mat33.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2PositionSolverManifold.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2OBB.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2Pair.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2FixtureDef.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2ContactID.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Common/Math/b2Transform.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/Shapes/b2EdgeShape.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Controllers/b2BuoyancyController.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2Body.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2ContactImpulse.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Controllers/b2TensorDampingController.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2ManifoldPoint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/Shapes/b2PolygonShape.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2Fixture.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2DynamicTreeNode.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2BodyDef.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2DynamicTreeBroadPhase.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2BroadPhase.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2Manifold.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/Shapes/b2CircleShape.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2Joint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2LineJoint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2ContactSolver.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2Simplex.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2WeldJoint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Common/Math/b2Math.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2PulleyJoint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2PrismaticJoint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2RevoluteJoint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2JointDef.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2LineJointDef.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2DistanceJoint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2PulleyJointDef.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2DistanceJointDef.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2FrictionJointDef.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2WeldJointDef.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2GearJointDef.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Common/b2Color.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2FrictionJoint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2Distance.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2MouseJoint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2PrismaticJointDef.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2TimeOfImpact.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2GearJoint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2TOIInput.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2RevoluteJointDef.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Joints/b2MouseJointDef.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2Contact.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2ContactConstraint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2ContactResult.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2PolygonContact.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/ClipVertex.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2ContactFilter.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2NullContact.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2ContactListener.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2Island.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2PolyAndEdgeContact.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2Collision.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2PolyAndCircleContact.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Collision/b2ContactPoint.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2CircleContact.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/Contacts/b2EdgeAndCircleContact.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2ContactManager.js" type="text/javascript"></script>
	<script src="../javascript/Box2D/Dynamics/b2World.js" type="text/javascript"></script>
	-->
	
	<style>
		body {
			font-size: 9px;
		}
		table {
			display: table;
			width: 100%;
		}
		table tr {
			display: table-cell;
			vertical-align: top;
		}
		table tr td {
			display: block;
		}
		table tr th {
			display: block;
			font-size: 20px;
			text-align: left;
			text-decoration: underline;
		}
		button {
			width: 175px;
		}
	</style>
</head>
<body>
	<h1>Bonk.io AI Trainer</h1>
	<canvas style = "margin-left: auto; margin-right: auto; display: block;" tabindex = "1" id="canvas" width="800"  height="600"></canvas>
	<hr>
	<table>
		<tr>
			<th>Speed Settings</th>
			<td><button id="supaSpeedUp" >speed up</button></td>
			<td><button id="supaSpeedDown" >speed down</button></td>
			<td><button id="toggleDraw" >toggle drawing</button></td>
			<td><button id="togglePause" >pause</button></td>
		</tr>
		<tr>
			<th>Save Settings</th>
			<td><button id="saveRedNN" >save red player</button></td>
			<td><button id="saveBlueNN" >save blue player</button></td>
			<td><button id="saveTournamentWinner" >save tournament winner</button></td>
		</tr>
		<tr>
			<th>NN Testing</th>
			<td><button id="toggleTestingMode" >toggle testing mode</button></td>
			<td><button id="loadModel" >load model (testing only)</button></td>
			<td><button id="downloadModel" >download model</button></td>
			<td><button id="loadPretrained" >load pretrained model</button></td>
			<td><button id="nextMap" >next map</button></td>
		</tr>
		<tr>
			<th>Debugging</th>
			<td><button id="toggleDebug" >toggle debug</button></td>
		</tr>
	</table>
	<hr>

	<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.0/dist/tf.min.js"></script>
	<!-- <script>
		console.log(tf);
	</script> -->
	<!-- worked! -->
	<script src="../javascript/Box2D/box2d.min.js" type="text/javascript"></script> 

	<script src="jquery.min.js"></script>
	
	<script src="gameEngine.js"></script>
	<script src="DEATH.js"></script>
	<script src="flatMap.js"></script>
	<script src="spacedOutPlatforms.js"></script>
	<script src="wallMap.js"></script>
	<script src="forNovices.js"></script>
	<script src="angledPlatforms.js"></script>
	<script type="text/javascript">

	$(document).ready(function(){
		
		window.runners = [angledPlatforms, DEATH, angledMap, spacedOutPlatforms, wallMap];
		window.level = 0;
		window.runner = null;
		window.scores = [0,0];

		function resetCurrentRunner() {
			window.up = [false, false];
			window.down = [false, false];
			window.left = [false, false];
			window.right = [false, false];
			window.space = [false, false];
			window.wasPaused = false;
			if(window.runner) {
				window.wasPaused = runner.isPaused();
				window.runner.destroy();
			}
			window.runner = new window.runners[window.level]($("#canvas")[window.level]);
			if(window.wasPaused)
				window.runner.draw();
			else	
				window.runner.resume();
		}
		
		resetCurrentRunner();
				
		$('#reset').click(function(){
			resetCurrentRunner();
		});
		
		$('#step').click(function(){
			runner.step(1/120);
			runner.draw();
		});
		
		$('#togglePause').click(function(){
			if (window.runner.isPaused()) {
				runner.resume();
				document.getElementById("togglePause").textContent = "pause";
			} else {
				runner.pause();
				document.getElementById("togglePause").textContent = "resume";
			}
		});
		
		$('#supaSpeedUp').click(function(){
			runner.supaSpeedUp();
		});
		
		$('#supaSpeedDown').click(function(){
			runner.supaSpeedDown();
		});
		
		$('#saveRedNN').click(function(){
			window.saveRedNN = true;
		});
		
		$('#saveBlueNN').click(function(){
			window.saveBlueNN = true;
		});

		$('#saveTournamentWinner').click(function(){
			window.saveTourneyWinner = true;
		});

		$('#toggleTestingMode').click(function(){
			if (window.testingMode) {
				window.testingMode = false;
			} else {
				window.testingMode = true;
			}
			window.testingChange = true;
		});
		$('#loadModel').click(function(){
			window.path = prompt("Please enter file path to the neural network", "localstorage://savedModel");
			getModel();
		});
		async function getModel() {
			window.testModel = await tf.loadLayersModel(window.path);
			console.log(window.testModel);
		}
		$('#downloadModel').click(function(){
			window.fileName = prompt("Please enter the desired file name", "savedModel");
			window.testModel.model.save("downloads://"+window.fileName);
		});
		$('#loadPretrained').click(function(){
			window.path = "https://quicktobeslow.github.io/Bonk_Remake/Bonkio_Remake/PTModel2.json";
			getModel();
		});
		$('#nextMap').click(function(){
			window.level++;
			if (window.level >= window.runners.length) {window.level = 0;}
		});
		$('#toggleDebug').click(function(){
			window.debug = (window.debug) ? false : true;
		});
		$('#toggleDraw').click(function(){
			window.draw = (window.draw) ? false : true;
		});
	});

	</script>
</body>
</html>
